#!/usr/bin/env python2
from pwn import * # https://pypi.python.org/pypi/pwntools
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('host', nargs='?', default='localhost')
parser.add_argument('port', nargs='?', default=8000, type=int)
args = parser.parse_args()
context.log_level = 'debug'
p = remote(args.host, args.port)

from Crypto.Util.number import *
import ast
while True:
    p.recvuntil('\xf0\x9f\x94\x92 1. ')
    n = [ None ] * 3
    c = [ None ] * 3
    n[0], e, c[0] = ast.literal_eval(p.recvline())
    p.recvuntil('\xf0\x9f\x94\x92 2. ')
    n[1], e, c[1] = ast.literal_eval(p.recvline())
    p.recvuntil('\xf0\x9f\x94\x92 3. ')
    n[2], e, c[2] = ast.literal_eval(p.recvline())
    for i in range(3):
        m = bytes_to_long('WIN \xf0\x9f\x92\x8e')
        if pow(m, e, n[i]) == c[i]:
            p.sendlineafter('>>> ', str(i + 1))
            break
    else:
        assert False
    p.recvuntil('you win')
